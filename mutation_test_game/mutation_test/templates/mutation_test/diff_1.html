{% extends "../inherit/sample.html" %}

{% block head %}
<style>
    .relative1 {
    position: relative;
    }
    .relative2 {
    position: relative;
    top: -30px;
    left: 10px;
    width: 500px;
    background-color: rgba(255,255,255,0);
    }

    .overflow_scroll{   
        overflow:scroll;
    }

    .wh30060{
        width:400px;
        height:300px;
    }
    
</style>

<style>
    .graph {
    position: relative; /* IE is dumb */
    width: 500px;
    border: 1px solid #B1D632;
    padding: 2px;
    }
    .graph .bar {
    display: block;
    position: static;
    background: #B1D632;
    text-align: center;
    color: #333;
    height: 2em;
    line-height: 2em;
    }
</style>

{% endblock %}

{% block temp %}

<div class="container">
    <div class="row">
        <div class="col-6">
            <h1 class="" style="margin-top:20px;">Level-1</h1>
        </div>

        <div class="col-6">
            <h1 class="" style="margin-top:20px;">Ans</h1>
        </div>
    </div>

    <div class='row'>
        <!-- <div class="col-6">
            <button type="button" class="btn btn-primary btn-sm" onclick='ans_before()'>變異前</button>
            <button type="button" class="btn btn-secondary btn-sm" onclick='ans_after()'>變異後 </button>
        </div> -->
        
        <button type = "button" class="btn btn-primary btn-sm" onclick="before()">變異1</button>
        <button type = "button" class="btn btn-secondary btn-sm" onclick="after()">變異2</button>
        <button type = "button" class="btn btn-primary btn-sm" onclick="assert_part()">變異3</button>
    </div>
    <div class="row">
        <div id="div_pre" class="col-6 border overflow_scroll wh30060">
<pre id='unmutate' style="">
# 變異前
def T35(NumX):
    if 3 > NumX:
        return "yes"
    else:
        return "no"
</pre>

<pre id='mutated' style="display:none">
# 變異後
def T35(NumX):
    if 3 < NumX:
        return "yes"
    else:
        return "no"
</pre>

<pre id='assert_part' style="display:none">
# assert_func
import T35
def assert_func(ans,NumX):
    if T35(NumX) == ans:
        return "通過"
    else:
        return "失敗"
ans = "no"
print(assert_func(ans, NumX))
</pre>
{% for item in all_shukudai %}
    <pre id='' style="display:none">
{{item}}
    </pre>
{% endfor %}

        </div>
        <!-- <div class="col-3 align-self-end">
            {% csrf_token %}
            <input type='text' class=' rounded' name="file1" required="" id= "Num" placeholder='   輸入NumX'>
            <input type="hidden" name="page" value="diff_1">
            <br>
            <button type='button' class='border-light rounded' onclick="loadXMLDoc()">Test</button>
        </div> -->
        <div id="div_ans" class="col-3">
            <!-- <input class="user rounded " name="user" autocomplete="off" style="width: 30%; margin-left: 1px; margin-top: 1px;">
            <input class="user rounded " name="user" autocomplete="off" style="width: 30%; margin-left: 1px; margin-top: 1px;">
            <input class="user rounded " name="user" autocomplete="off" style="width: 30%; margin-left: 1px; margin-top: 1px;">
            <input class="user rounded " name="user" autocomplete="off" style="width: 30%; margin-left: 1px; margin-top: 1px;"> -->
        </div>
        <div class="col-3">
            {% csrf_token %}
            <button type='button' class='border-light rounded' onclick="add_ans()">Add Ans</button>
            <input type="hidden" name="page" value="diff_1">
            <input type="hidden" name="bangou" value="{{bangou}}">
            <br>
            <button type='button' class='border-light rounded' onclick="loadXMLDoc()">Test</button>

        </div>
    </div>
    
    <h1 class="pt1" style="">執行結果</h1>
    <div class='row pt1'>
        
        <button type="button" class="btn btn-primary btn-sm" onclick='ans_before()'>變異前</button>
        <button type="button" class="btn btn-secondary btn-sm" onclick='ans_after()'>變異後 </button>
    </div>

    <div class="row">
        <div class="col-6 border overflow_scroll wh30060 ">
<pre id='output_before' style="display:none" >
</pre>
<pre id='output_after' style="display:none" >
</pre>
        </div>
        <div class = "col-3" id="timecount">
            {{timecout}}
        </div>
    <!--
        <div class='col-6'>
            <div class="graph">
            <strong id="myBar" class="bar relative1" style="width:0%;"></strong>
            </div>  
            <p class='text-center relative2'>kill rate</p>
            <p id='myP' class='text-center relative2' ></p>
            <p id='myp2' class='text-center relative2' ></p>
        </div>
    -->

    </div>


</div>

  


<!-- 預先載入的物件 -->
<script>
    var parent = document.getElementById("div_ans")
    for(i=0; i < 6; i++){
        var input = document.createElement("input")
        input.setAttribute("class", "user rounded")
        input.setAttribute("name", "user")
        input.setAttribute("Placeholder", "Num")
        input.style.cssText = "width:30%;margin-left:1px;margin-top:1px";
        parent.appendChild(input)
    }

</script>
<!-- 預先載入的物件 -->

<!-- 預先載入題目 -->
<script>
    
    function loadshukudai(){
        var xhttp = new XMLHttpRequest();
    
        xhttp.onreadystatechange=function()
        {
            if (xhttp.readyState==4 && xhttp.status==200)
                {
                    js_shukudai = JSON.parse(xhttp.response)
                    // console.log(js_shukudai.all_shukudai[0])
                    
                    var parent = document.getElementById("div_pre")
                    for(i=0 ;i<js_shukudai.all_shukudai.length ;i++){
                        var pre = document.createElement("pre")
                        pre.style.cssText = "display:none";
                        pre.innerHTML = js_shukudai.all_shukudai[i]
                        parent.appendChild(pre)
                    }
                    // <pre id='assert_part' style="display:none">
                }
        }

        xhttp.open("GET", "{% url 'diff_1_load' %}", true);
        xhttp.send();
    }
    loadshukudai()

</script>
<!-- 預先載入題目 -->


<!-- 送資料到後端 ajax -->
<script>
    function loadXMLDoc()
    {
        var xmlhttp;

        if (document.getElementsByName("Num").value == '')
            {
                alert("請輸入數字")
                return;
            }
        if (window.XMLHttpRequest)
            {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp=new XMLHttpRequest();
            }
        else
            {// code for IE6, IE5
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
            }
        xmlhttp.onreadystatechange=function()
        {
            if (xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    js_ans = JSON.parse(xmlhttp.response)
                    output_before = document.getElementById("output_before"); 
                    output_after = document.getElementById("output_after");
                    output_before.innerHTML = "變異前:\n" + js_ans.ans1;
                    output_after.innerHTML = "變異後:\n" + js_ans.ans2;
                    unmutate = document.getElementById('output_before');
                    unmutate.style.cssText = "";
                }
        }
        /*抓input*/
        var upload_pic = new Array()
        var len = document.querySelectorAll(".user").length
        for(var i = 0; i < len; i++){
            var v = document.querySelectorAll(".user")[i].value
            upload_pic.push(v)
        }
        
        xmlhttp.open("POST","{% url 'diff_1' %}",true);
        xmlhttp.setRequestHeader('Conten-Type', 'application/x-www-foorm-urlencoded;charset-UTF-8');  //POST資料請求頭
        var Num_obj = document.getElementsByName("Num").value;
        var data = new FormData();
        data.append("bangou", $("[name='bangou']").val())
        data.append("csrfmiddlewaretoken",$("[name='csrfmiddlewaretoken']").val());
        data.append("Num", Num_obj);
        data.append("input", upload_pic);
        console.log(document.getElementsByName('bangou').value)
        xmlhttp.send(data);
    }
</script>
<!-- 送資料到後端 ajax -->


<!-- BUTTOM 控制 -->
<script>

function before(){
    unmutate = document.getElementById('unmutate');
    mutated = document.getElementById('mutated');
    unmutate.style.cssText = "";
    mutated.style.cssText = "display:none";
    assert.style.cssText = "display:none";
}
function after(){
    unmutate = document.getElementById('unmutate');
    mutated = document.getElementById('mutated');
    mutated.style.cssText = "";
    unmutate.style.cssText = "display:none";
    assert.style.cssText = "display:none";
}

function assert_part(){
    assert = document.getElementById('assert_part');
    unmutate = document.getElementById('unmutate');
    mutated = document.getElementById('mutated');
    assert.style.cssText = "";
    unmutate.style.cssText = "display:none";
    mutated.style.cssText = "display:none";
}

function ans_before(){
    unmutate = document.getElementById('output_before');
    mutated = document.getElementById('output_after');
    unmutate.style.cssText = "";
    mutated.style.cssText = "display:none";
}
function ans_after(){
    unmutate = document.getElementById('output_before');
    mutated = document.getElementById('output_after');
    unmutate.style.cssText = "display:none";
    mutated.style.cssText = "";
}
function add_ans(){
    var parent = document.getElementById("div_ans")
    var input = document.createElement("input")
    input.setAttribute("class", "user rounded")
    // input.setAttribute("id", "Num")
    input.setAttribute("name", "user")
    input.setAttribute("Placeholder", "Num")
    input.style.cssText = "width:30%;margin-left:1px;margin-top:1px";
    parent.appendChild(input)
}
</script>
<!-- BUTTOM 控制 -->
<!-- 計時器運行 -->
<script>
    var id = setInterval(TimeCount, 1000);
    function TimeCount(){
        time = document.getElementById("timecount")
        console.log(time)
        Timearr = time.innerHTML.replace(" ","").split(":")
        console.log(Timearr)
        min = parseInt(Timearr[0])
        sec = parseInt(Timearr[1])
        console.log(min,sec)
        sec += 1
        if (sec%60 == 0){
            min += 1
            if (min < 10){
                min = "0" + min.toString()
            }
            sec = "0" + 00.toString()
            time.innerHTML = min.toString() + ":" + sec
        }else {
            if (min < 10){
                min = "0" + min.toString()
            }
            if (sec < 10){
                sec = "0" + sec.toString()
            }
            
            time.innerHTML = min.toString() + ":" + sec.toString()
        }
        
        
    }

</script>

{% endblock %}